<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="This is a personal website."><title>常用JavaScript代码片段 | 少平</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.2"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">常用JavaScript代码片段</h1><a id="logo" href="/.">少平</a><p class="description">技术改变生活</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">常用JavaScript代码片段</h1><div class="post-meta">Jan 4, 2018<span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.9k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 19</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-数组去重"><span class="toc-number">1.</span> <span class="toc-text">1. 数组去重</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-冒泡排序"><span class="toc-number">2.</span> <span class="toc-text">2. 冒泡排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-快排"><span class="toc-number">3.</span> <span class="toc-text">3.快排</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-判断非空对象"><span class="toc-number">4.</span> <span class="toc-text">4. 判断非空对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-深拷贝"><span class="toc-number">5.</span> <span class="toc-text">5.深拷贝</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6-typeof类型判断"><span class="toc-number">6.</span> <span class="toc-text">6. typeof类型判断</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-继承"><span class="toc-number">7.</span> <span class="toc-text">7.继承</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-实现栈堆操作"><span class="toc-number">8.</span> <span class="toc-text">8. 实现栈堆操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-模拟sort方法"><span class="toc-number">9.</span> <span class="toc-text">9. 模拟sort方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10-sleep"><span class="toc-number">10.</span> <span class="toc-text">10. sleep()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-节流防抖"><span class="toc-number">11.</span> <span class="toc-text">11.节流防抖</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-柯里化"><span class="toc-number">12.</span> <span class="toc-text">12.柯里化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#13-数组拆解"><span class="toc-number">13.</span> <span class="toc-text">13.数组拆解</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#14-数组乱序"><span class="toc-number">14.</span> <span class="toc-text">14.数组乱序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#15-insertAfter-dom操作"><span class="toc-number">15.</span> <span class="toc-text">15. insertAfter(dom操作)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#16-实现new"><span class="toc-number">16.</span> <span class="toc-text">16.实现new</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#17-instanceof"><span class="toc-number">17.</span> <span class="toc-text">17.instanceof</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#18-jsonp"><span class="toc-number">18.</span> <span class="toc-text">18.jsonp</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#19-promise"><span class="toc-number">19.</span> <span class="toc-text">19.promise</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#20-实现一个路由-Hash-实现原理就是监听-url-的哈希值变化了"><span class="toc-number">20.</span> <span class="toc-text">20.实现一个路由 - Hash(实现原理就是监听 url 的哈希值变化了)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#21-路由实现-history"><span class="toc-number">21.</span> <span class="toc-text">21.路由实现 - history</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#22-实现call-apply-bind"><span class="toc-number">22.</span> <span class="toc-text">22.实现call,apply,bind</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#23-取数组最大值"><span class="toc-number">23.</span> <span class="toc-text">23.取数组最大值</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#24-统计一个字符串中出现次数最多字符。"><span class="toc-number">24.</span> <span class="toc-text">24.统计一个字符串中出现次数最多字符。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#24-two-sum找出一个数组中和为给定值的两个数的下标"><span class="toc-number">25.</span> <span class="toc-text">24.two-sum找出一个数组中和为给定值的两个数的下标?</span></a></li></ol></div></div><div class="post-content"><h5 id="1-数组去重"><a href="#1-数组去重" class="headerlink" title="1. 数组去重"></a>1. 数组去重</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.unique = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> temp = &#123;&#125;,</span><br><span class="line">		arr = [],</span><br><span class="line">		len = <span class="keyword">this</span>.length;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(!temp[<span class="keyword">this</span>[i]]) &#123;</span><br><span class="line">				temp[<span class="keyword">this</span>[i]] = <span class="string">'abc'</span>;</span><br><span class="line">				arr.push(<span class="keyword">this</span>[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">76</span>,<span class="number">8</span>,<span class="number">42</span>,<span class="string">'acb'</span>,<span class="string">'acb'</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.unique());</span><br></pre></td></tr></table></figure>
<h5 id="2-冒泡排序"><a href="#2-冒泡排序" class="headerlink" title="2. 冒泡排序"></a>2. 冒泡排序</h5><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span><span class="params">(arr)</span> &#123;</span></span><br><span class="line">	<span class="keyword">for</span>(var <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt; arr.<span class="built_in">length</span>; <span class="built_in">i</span>++) &#123;</span><br><span class="line">		var isSort = <span class="built_in">true</span>;</span><br><span class="line">		<span class="keyword">for</span>(var <span class="built_in">j</span> = <span class="number">0</span> ; <span class="built_in">j</span> &lt;arr.<span class="built_in">length</span> <span class="number">-1</span> -<span class="built_in">i</span>; <span class="built_in">j</span>++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(arr[<span class="built_in">j</span>] &gt; arr[<span class="built_in">j</span> + <span class="number">1</span>]) &#123;</span><br><span class="line">				isSort = <span class="built_in">false</span>;</span><br><span class="line">				var tmp =  arr[<span class="built_in">j</span>] ;</span><br><span class="line">				arr[<span class="built_in">j</span>] = arr[<span class="built_in">j</span> + <span class="number">1</span>];</span><br><span class="line">				arr[<span class="built_in">j</span> + <span class="number">1</span>] = tmp;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(isSort) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">var arr = [<span class="number">3</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"><span class="built_in">sort</span>(arr);</span><br></pre></td></tr></table></figure>
<h5 id="3-快排"><a href="#3-快排" class="headerlink" title="3.快排"></a>3.快排</h5><ul>
<li>选择基准值(base)，原数组长度减一(基准值)，使用 splice</li>
<li>循环原数组，小的放左边(left数组)，大的放右边(right数组);</li>
<li>concat(left, base, right)</li>
<li>递归继续排序 left 与 right<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function <span class="built_in">quickSort</span>(arr) &#123;</span><br><span class="line">    <span class="keyword">if</span>(arr.length &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> arr;  <span class="comment">//递归出口</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">left</span> = [],</span><br><span class="line">        <span class="keyword">right</span> = [],</span><br><span class="line">        current = arr.splice(<span class="number">0</span>,<span class="number">1</span>); </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[i] &lt; current) &#123;</span><br><span class="line">            <span class="keyword">left</span>.push(arr[i])  <span class="comment">//放在左边</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">right</span>.push(arr[i]) <span class="comment">//放在右边</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">quickSort</span>(<span class="keyword">left</span>).concat(current,<span class="built_in">quickSort</span>(<span class="keyword">right</span>));</span><br><span class="line">&#125;</span><br><span class="line">console.log(<span class="built_in">quickSort</span>([<span class="number">111</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">99</span>,<span class="number">33</span>]))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="4-判断非空对象"><a href="#4-判断非空对象" class="headerlink" title="4. 判断非空对象"></a>4. 判断非空对象</h5><ul>
<li><p>for…in…遍历属性，为真则为“非空数组”；否则为“空数组”</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jus</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">'非空对象'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">console</span>.log(<span class="string">'空对象'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">q</span>:<span class="number">2</span>&#125;;</span><br><span class="line">jus(obj)</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过JSON自带的.stringify方法来判断：  兼容IE8</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jus1</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">JSON</span>.stringify(obj)==<span class="string">'&#123;&#125;'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'空'</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'非空'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">jus1(obj)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ES6新增的方法Object.keys():</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">jus2</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.keys(obj).length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'空对象'</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'非空对象'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">jus2(obj)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="5-深拷贝"><a href="#5-深拷贝" class="headerlink" title="5.深拷贝"></a>5.深拷贝</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">var obj1 = &#123;</span><br><span class="line">   <span class="built_in"> name</span>: <span class="string">'zs'</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    sex: <span class="string">'男'</span>,</span><br><span class="line">    dog: &#123;</span><br><span class="line">       <span class="built_in"> name</span>: <span class="string">'金毛'</span>,</span><br><span class="line">        age: <span class="number">2</span>,</span><br><span class="line">        yellow: <span class="string">'黄色'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    friends: [<span class="string">'lilei'</span>, <span class="string">'hanmeimei'</span>]</span><br><span class="line">&#125;</span><br><span class="line">var obj1 = &#123;</span><br><span class="line">   <span class="built_in"> name</span>: <span class="string">'zs'</span>,</span><br><span class="line">    age: <span class="number">18</span>,</span><br><span class="line">    sex: <span class="string">'男'</span>,</span><br><span class="line">    dog: &#123;</span><br><span class="line">       <span class="built_in"> name</span>: <span class="string">'金毛'</span>,</span><br><span class="line">        age: <span class="number">2</span>,</span><br><span class="line">        yellow: <span class="string">'黄色'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    friends: [<span class="string">'lilei'</span>, <span class="string">'hanmeimei'</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> deepCopy(obj) &#123;</span><br><span class="line">var result = Array.isArray(obj) ? [] : &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (var<span class="built_in"> key</span> <span class="keyword">in</span> obj) &#123;</span><br><span class="line">        <span class="keyword">if</span> (obj.hasOwnProperty<span class="built_in">(key</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (typeof obj<span class="built_in">[key</span>] === <span class="string">'object'</span>) &#123;</span><br><span class="line">            result<span class="built_in">[key</span>] = deepCopy(obj<span class="built_in">[key</span>]);   //递归复制</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result<span class="built_in">[key</span>] = obj<span class="built_in">[key</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">var obj2 = deepCopy(obj1);</span><br><span class="line">obj2.dog<span class="built_in">.name</span> = <span class="string">'改了'</span></span><br><span class="line">console.log(obj2,obj1)</span><br></pre></td></tr></table></figure>
<h5 id="6-typeof类型判断"><a href="#6-typeof类型判断" class="headerlink" title="6. typeof类型判断"></a>6. typeof类型判断</h5><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function <span class="class"><span class="keyword">type</span>(<span class="params">target</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ret = typeof(target);</span><br><span class="line">	<span class="keyword">var</span> template = &#123;</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Array</span>]' </span>: <span class="symbol">'arra</span>y',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Object</span>]' </span>: <span class="symbol">'objec</span>t',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Number</span>]' </span>: <span class="symbol">'numbe</span>r',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Bollean</span>' </span>: <span class="symbol">'bollea</span>n',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">String</span>]' </span>: <span class="symbol">'strin</span>g',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Error</span>]' </span>: <span class="symbol">'erro</span>r',</span><br><span class="line">		'[<span class="class"><span class="keyword">object</span> <span class="title">Symbol</span>]' </span>: <span class="symbol">'symbo</span>l'</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(target === <span class="literal">null</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="symbol">'nul</span>l';</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(ret == <span class="symbol">'objec</span>t') &#123;</span><br><span class="line">		<span class="keyword">var</span> str = <span class="type">Object</span>.prototype.toString.call(target);</span><br><span class="line">		<span class="keyword">return</span> template[str];</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> name = <span class="type">Symbol</span>();</span><br><span class="line">console.log(<span class="class"><span class="keyword">type</span>(<span class="params">name</span>))</span>;</span><br></pre></td></tr></table></figure>
<h5 id="7-继承"><a href="#7-继承" class="headerlink" title="7.继承"></a>7.继承</h5><ul>
<li>组合继承<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.name = <span class="string">'parent'</span>;</span><br><span class="line">	<span class="keyword">this</span>.play = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	Parent.call(<span class="keyword">this</span>);</span><br><span class="line">	<span class="keyword">this</span>.type = <span class="string">'child'</span>;</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype = <span class="keyword">new</span> Parent();</span><br><span class="line">Child.prototype.constructor = Child;</span><br><span class="line"><span class="keyword">var</span> s3 = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="keyword">var</span> s4 = <span class="keyword">new</span> Child();</span><br><span class="line">s3.play.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(s3.play, s4.play);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="8-实现栈堆操作"><a href="#8-实现栈堆操作" class="headerlink" title="8. 实现栈堆操作"></a>8. 实现栈堆操作</h5><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// <span class="number">1</span>.用两个栈来实现一个队列，完成队列的<span class="built_in">push</span>和 <span class="built_in">pop</span>操作，队列中的元素类型为int类型</span><br><span class="line">// 栈： 先进后出、后进先出</span><br><span class="line">// 队列： 先进先出、后进后出</span><br><span class="line"></span><br><span class="line"><span class="built_in">var</span> originArr =  [];</span><br><span class="line"><span class="built_in">var</span> targetArr =  [];</span><br><span class="line">function <span class="built_in">push</span>(node) &#123;</span><br><span class="line">	<span class="keyword">if</span> (node) &#123;</span><br><span class="line">		originArr.<span class="built_in">push</span>(node);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span></span><br><span class="line">&#125;</span><br><span class="line">function <span class="built_in">pop</span> () &#123;</span><br><span class="line">	<span class="built_in">var</span> originLen = originArr.<span class="built_in">length</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">var</span> i = <span class="number">0</span>; i &lt; originLen; i++)&#123;</span><br><span class="line">		targetArr.<span class="built_in">push</span>(originArr.<span class="built_in">pop</span>());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">var</span> result = targetArr.<span class="built_in">pop</span>();</span><br><span class="line">	<span class="built_in">var</span> targetLen = targetLen.<span class="built_in">length</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">var</span>  j = <span class="number">0</span>; j &lt; targetLen; j++) &#123;</span><br><span class="line">		originArr.<span class="built_in">push</span>(targetArr.<span class="built_in">pop</span>())</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="9-模拟sort方法"><a href="#9-模拟sort方法" class="headerlink" title="9. 模拟sort方法"></a>9. 模拟sort方法</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params">numbers, fn</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; numbers.length - <span class="number">1</span> ; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> isSort = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; numbers.length <span class="number">-1</span> - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(fn(numbers[j],numbers[j+<span class="number">1</span>]) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                isSort = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">var</span> tmp = numbers[j];</span><br><span class="line">                numbers[j] = numbers[j+<span class="number">1</span>];</span><br><span class="line">                numbers[j+<span class="number">1</span>] = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(isSort) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">numbers = [<span class="number">7</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">8</span>];</span><br><span class="line"> sort(numbers, <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> a - b</span><br><span class="line"> &#125;); <span class="comment">//通过 a - b 或 b - a 判断从大到小排还是从小到大排</span></span><br><span class="line"> <span class="built_in">console</span>.log(numbers);</span><br></pre></td></tr></table></figure>
<h5 id="10-sleep"><a href="#10-sleep" class="headerlink" title="10. sleep()"></a>10. sleep()</h5><ul>
<li>使用 async await 实现一个睡眠等待执行函数</li>
<li><p>如果await后跟的的是 promise对象会造成异步函数停止执行并且等待 promise 的解决,如果等的是正常的表达式则立即执行</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sleep = <span class="keyword">async</span> (duration) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(resolve, duration);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"start!"</span>+<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString());</span><br><span class="line">    <span class="keyword">await</span> sleep(<span class="number">2000</span>)<span class="comment">//阻塞该async方法的执行线程，直到sleep()返回的Promise resolve</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"end"</span>+<span class="keyword">new</span> <span class="built_in">Date</span>().toISOString());</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"after sleep test!"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>用Promise实现</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">time</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve,time))</span><br><span class="line">&#125;</span><br><span class="line">sleep(<span class="number">1000</span>).then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="11-节流防抖"><a href="#11-节流防抖" class="headerlink" title="11.节流防抖"></a>11.节流防抖</h5><ul>
<li><p>节流(throttle): 每隔一段时间执行一次，也就是降低频率，将高频操作优化成低频操作，通常使用场景: 滚动条事件 或者 resize 事件，通常每隔 100~500 ms执行一次即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">func, delay</span>) </span>&#123;           </span><br><span class="line">    <span class="keyword">var</span> prev = <span class="built_in">Date</span>.now();           </span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;               </span><br><span class="line">        <span class="keyword">var</span> context = <span class="keyword">this</span>;               </span><br><span class="line">        <span class="keyword">var</span> args = <span class="built_in">arguments</span>;               </span><br><span class="line">        <span class="keyword">var</span> now = <span class="built_in">Date</span>.now();               </span><br><span class="line">        <span class="keyword">if</span> (now - prev &gt;= delay) &#123;                   </span><br><span class="line">            func.apply(context, args);                   </span><br><span class="line">            prev = <span class="built_in">Date</span>.now();               </span><br><span class="line">        &#125;           </span><br><span class="line">    &#125;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>所谓防抖，就是指触发事件后在 n 秒内函数只能执行一次，如果在 n 秒内又触发了事件，则会重新计算函数执行时间。</p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span> 函数防抖</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> func 函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> wait 延迟执行毫秒数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> immediate true 表立即执行，false 表非立即执行</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span><span class="params">(func,wait,immediate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> context = this;</span><br><span class="line">        <span class="keyword">let</span> args = arguments;</span><br><span class="line">        <span class="keyword">if</span> (timeout) clearTimeout(timeout);</span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">            <span class="keyword">var</span> callNow = !timeout;</span><br><span class="line">            timeout = setTimeout(() =&gt; &#123;</span><br><span class="line">                timeout = <span class="keyword">null</span>;</span><br><span class="line">            &#125;, wait)</span><br><span class="line">            <span class="keyword">if</span> (callNow) func.apply(context, args)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            timeout = setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span><br><span class="line">                func.apply(context, args)</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="12-柯里化"><a href="#12-柯里化" class="headerlink" title="12.柯里化"></a>12.柯里化</h5><p>在一个函数中，首先填充几个参数，然后再返回一个新的函数的技术，称为函数的柯里化。通常可用于在不侵入函数的前提下，为函数 预置通用参数，供多次重复调用。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> add = <span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">y</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> x + y</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> add1 = add(<span class="number">1</span>)</span><br><span class="line">add1(<span class="number">2</span>) === <span class="number">3</span></span><br><span class="line">add1(<span class="number">20</span>) === <span class="number">21</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>实现一个curry函数，将普通函数进行柯里化:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fn, args = []</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(args,<span class="built_in">arguments</span>,fn.length)</span><br><span class="line">        <span class="keyword">let</span> rest = [...args, ...arguments];</span><br><span class="line">        <span class="keyword">if</span> (rest.length &lt; fn.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> curry.call(<span class="keyword">this</span>,fn,rest);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>,rest);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//test</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a,b,c</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b+c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> sumFn = curry(sum);</span><br><span class="line"><span class="built_in">console</span>.log(sumFn(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)); <span class="comment">//6</span></span><br><span class="line"><span class="built_in">console</span>.log(sumFn(<span class="number">1</span>)(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">//6</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="13-数组拆解"><a href="#13-数组拆解" class="headerlink" title="13.数组拆解"></a>13.数组拆解</h5><ul>
<li>数组拆解: flat: [1,[2,3]] –&gt; [1, 2, 3]<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.flat = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.toString().split(<span class="string">','</span>).map(<span class="function"><span class="params">item</span> =&gt;</span> +item )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="14-数组乱序"><a href="#14-数组乱序" class="headerlink" title="14.数组乱序"></a>14.数组乱序</h5><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line">arr.sort(function () &#123;</span><br><span class="line">    return Math.random() - <span class="number">0.5</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="15-insertAfter-dom操作"><a href="#15-insertAfter-dom操作" class="headerlink" title="15. insertAfter(dom操作)"></a>15. insertAfter(dom操作)</h5><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">insertAfter</span>(<span class="params">newEle,targetEle</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">parent</span> = targetEle.parentNode;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">parent</span>.lastChild == targetEle) &#123;</span><br><span class="line">        <span class="built_in">parent</span>.appendChild(newEle);</span><br><span class="line">    &#125;<span class="title">else</span> &#123;</span><br><span class="line">        <span class="built_in">parent</span>.insertBefore(newEle,targetEle.nextSibling)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(div);</span><br><span class="line">    <span class="keyword">var</span> p = <span class="built_in">document</span>.createElement(<span class="string">'p'</span>);</span><br><span class="line">    div.appendChild(p);</span><br><span class="line">    <span class="keyword">var</span> span =<span class="built_in">document</span>.createElement(<span class="string">'span'</span>);</span><br><span class="line">    insertAfter(span,p)</span><br></pre></td></tr></table></figure>
<h5 id="16-实现new"><a href="#16-实现new" class="headerlink" title="16.实现new"></a>16.实现new</h5><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 手动实现一个 new 关键字的功能的函数 _new(fun, args) --&gt; new fun(args)</span></span><br><span class="line">function _new(<span class="function"><span class="keyword">fun</span>, ...args) &#123;</span></span><br><span class="line">    <span class="keyword">if</span> (typeof <span class="function"><span class="keyword">fun</span> !== 'function') &#123;</span></span><br><span class="line">        <span class="keyword">return</span> new Error(<span class="string">'参数必须是一个函数'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    let obj = Object.create(<span class="function"><span class="keyword">fun</span>.prototype);</span></span><br><span class="line">    let res = <span class="function"><span class="keyword">fun</span>.<span class="title">call</span><span class="params">(obj, ...args)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (res !== <span class="literal">null</span> &amp;&amp; (typeof res === <span class="string">'object'</span> || typeof res === <span class="string">'function'</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="17-instanceof"><a href="#17-instanceof" class="headerlink" title="17.instanceof"></a>17.instanceof</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a instanceof b</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_instanceof</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (a) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a.__proto__ === b.prototype) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        a = a.__proto__;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="18-jsonp"><a href="#18-jsonp" class="headerlink" title="18.jsonp"></a>18.jsonp</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// foo 函数将会被调用 传入后台返回的数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'通过jsonp获取后台数据:'</span>, data);</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'data'</span>).innerHTML = data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过手动创建一个 script 标签发送一个 get 请求</span></span><br><span class="line"><span class="comment"> * 并利用浏览器对 &lt;script&gt; 不进行跨域限制的特性绕过跨域问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">jsonp</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> head = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>]; <span class="comment">// 获取head元素 把js放里面</span></span><br><span class="line">    <span class="keyword">let</span> js = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    js.src = <span class="string">'http://domain:port/testJSONP?a=1&amp;b=2&amp;callback=foo'</span>; <span class="comment">// 设置请求地址</span></span><br><span class="line">    head.appendChild(js); <span class="comment">// 这一步会发送请求</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后台代码</span></span><br><span class="line"><span class="comment">// 因为是通过 script 标签调用的 后台返回的相当于一个 js 文件</span></span><br><span class="line"><span class="comment">// 根据前端传入的 callback 的函数名直接调用该函数</span></span><br><span class="line"><span class="comment">// 返回的是 'foo(3)'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testJSONP</span>(<span class="params">callback, a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;callback&#125;</span>(<span class="subst">$&#123;a + b&#125;</span>)`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="19-promise"><a href="#19-promise" class="headerlink" title="19.promise"></a>19.promise</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PENDING = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> FULFILLED = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyPromise</span>(<span class="params">executor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">this</span>.resolveQueue = [];</span><br><span class="line">    <span class="keyword">this</span>.rejectQueue = [];</span><br><span class="line">    <span class="keyword">this</span>.state = PENDING;</span><br><span class="line">    <span class="keyword">this</span>.val = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (self.state === PENDING) &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                self.state = FULFILLED;</span><br><span class="line">                self.val = val;</span><br><span class="line">                self.resolveQueue.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb(val));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">reject</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (self.state === PENDING) &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                self.state = REJECTED;</span><br><span class="line">                self.val = err;</span><br><span class="line">                self.rejectQueue.forEach(<span class="function"><span class="params">cb</span> =&gt;</span> cb(err));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 回调是异步执行 函数是同步执行</span></span><br><span class="line">        executor(resolve, reject);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.prototype.then = <span class="function"><span class="keyword">function</span>(<span class="params">onResolve, onReject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// 不传值的话默认是一个返回原值的函数</span></span><br><span class="line">    onResolve = <span class="keyword">typeof</span> onResolve === <span class="string">'function'</span> ? onResolve : (<span class="function"><span class="params">v</span> =&gt;</span> v); </span><br><span class="line">    onReject = <span class="keyword">typeof</span> onReject === <span class="string">'function'</span> ? onReject : (<span class="function"><span class="params">e</span> =&gt;</span> &#123; <span class="keyword">throw</span> e &#125;);</span><br><span class="line">    <span class="keyword">if</span> (self.state === FULFILLED) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> x = onResolve(self.val);</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        resolve(x);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                    reject(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (self.state === REJECTED) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> x = onReject(self.val);</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        resolve(x);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                    reject(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (self.state === PENDING) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">            self.resolveQueue.push(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> x = onResolve(val);</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        resolve(x);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                    reject(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            self.rejectQueue.push(<span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> x = onReject(val);</span><br><span class="line">                    <span class="keyword">if</span> (x <span class="keyword">instanceof</span> MyPromise) &#123;</span><br><span class="line">                        x.then(resolve);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        resolve(x);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                    reject(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.prototype.catch = <span class="function"><span class="keyword">function</span>(<span class="params">onReject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.then(<span class="literal">null</span>, onReject);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.all = <span class="function"><span class="keyword">function</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> result = [];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; promises.length; i++) &#123;</span><br><span class="line">            promises[i].then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                result[i] = res;</span><br><span class="line">                <span class="keyword">if</span> (++cnt === promises.length) resolve(result);</span><br><span class="line">            &#125;, err =&gt; &#123;</span><br><span class="line">                reject(err);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.race = <span class="function"><span class="keyword">function</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; promises.length; i++) &#123;</span><br><span class="line">            promises[i].then(resolve, reject);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.resolve = <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        resolve(val);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MyPromise.reject = <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyPromise(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        reject(err);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="20-实现一个路由-Hash-实现原理就是监听-url-的哈希值变化了"><a href="#20-实现一个路由-Hash-实现原理就是监听-url-的哈希值变化了" class="headerlink" title="20.实现一个路由 - Hash(实现原理就是监听 url 的哈希值变化了)"></a>20.实现一个路由 - Hash(实现原理就是监听 url 的哈希值变化了)</h5><ul>
<li>hash模式：在浏览器中符号“#”，#以及#后面的字符称之为hash，用window.location.hash读取；<br>特点：hash虽然在URL中，但不被包括在HTTP请求中；用来指导浏览器动作，对服务端安全无用，hash不会重加载页面。<br>hash 模式下，仅 hash 符号之前的内容会被包含在请求中，如 <a href="http://www.xxx.com，因此对于后端来说，即使没有做到对路由的全覆盖，也不会返回" target="_blank" rel="noopener">http://www.xxx.com，因此对于后端来说，即使没有做到对路由的全覆盖，也不会返回</a> 404 错误。<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, <span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">      let content = <span class="built_in">document</span>.getElementById(<span class="string">'content'</span>);</span><br><span class="line">      content.innerText = location.hash;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="21-路由实现-history"><a href="#21-路由实现-history" class="headerlink" title="21.路由实现 - history"></a>21.路由实现 - history</h5><ul>
<li>history模式：history采用HTML5的新特性；且提供了两个新方法：pushState（），replaceState（）可以对浏览器历史记录栈进行修改，以及popState事件的监听到状态变更。<br>history 模式下，前端的 URL 必须和实际向后端发起请求的 URL 一致，如 <a href="http://www.xxx.com/items/id。后端如果缺少对" target="_blank" rel="noopener">http://www.xxx.com/items/id。后端如果缺少对</a> /items/id 的路由处理，将返回 404 错误。Vue-Router 官网里如此描述：“不过这种模式要玩好，还需要后台配置支持……所以呢，你要在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。”<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function changeRoute(route) &#123;</span><br><span class="line">      let path = route.dataset.path;</span><br><span class="line">      /**</span><br><span class="line">       * window.history.pushState(<span class="keyword">state</span>, title, url)</span><br><span class="line">       * <span class="keyword">state</span>：一个与添加的记录相关联的状态对象，主要用于popstate事件。该事件触发时，该对象会传入回调函数。</span><br><span class="line">       *        也就是说，浏览器会将这个对象序列化以后保留在本地，重新载入这个页面的时候，可以拿到这个对象。</span><br><span class="line">       *        如果不需要这个对象，此处可以填 null。</span><br><span class="line">       * title：新页面的标题。但是，现在所有浏览器都忽视这个参数，所以这里可以填空字符串。</span><br><span class="line">       * url：新的网址，必须与当前页面处在同一个域。浏览器的地址栏将显示这个网址。</span><br><span class="line">       */</span><br><span class="line">  changePage(path);</span><br><span class="line">  history.pushState(&#123; content: path &#125;, null, path);</span><br><span class="line">&#125;</span><br><span class="line">/**</span><br><span class="line"> * 调用 history.pushState() 或者 history.replaceState() 不会触发 popstate 事件。</span><br><span class="line"> * 点击后退、前进按钮、或者在 js 中调用 history.back()、history.forward()、history.go() 方法会触发</span><br><span class="line"> */ </span><br><span class="line">window.addEventListener('popstate', (e) =&gt; &#123;</span><br><span class="line">  let content = e.<span class="keyword">state</span> &amp;&amp; e.<span class="keyword">state</span>.content;</span><br><span class="line">  changePage(content);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function changePage(pageContent) &#123;</span><br><span class="line">  let content = document.getElementById('content');</span><br><span class="line">  content.innerText = pageContent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="22-实现call-apply-bind"><a href="#22-实现call-apply-bind" class="headerlink" title="22.实现call,apply,bind"></a>22.实现call,apply,bind</h5><ul>
<li><p>call</p>
<blockquote>
<p>1.将函数设为传入参数的属性<br>2.指定this到函数并传入给定参数执行函数<br>3.如果不传入参数或者参数为null，默认指向为 window / global<br>4.删除参数上的函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.call = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="comment">/** 如果第一个参数传入的是 null 或者是 undefined, 那么指向this指向 window/global */</span></span><br><span class="line">    <span class="comment">/** 如果第一个参数传入的不是null或者是undefined, 那么必须是一个对象 */</span></span><br><span class="line">    <span class="keyword">if</span> (!context) &#123;</span><br><span class="line">        <span class="comment">//context为null或者是undefined</span></span><br><span class="line">        context = <span class="keyword">typeof</span> <span class="built_in">window</span> === <span class="string">'undefined'</span> ?global :<span class="built_in">window</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    context.fn = <span class="keyword">this</span>; <span class="comment">//this指向的是当前的函数(Function的实例)</span></span><br><span class="line">    <span class="keyword">let</span> args = [...arguments].slice(<span class="number">1</span>);<span class="comment">//获取除了this指向对象以外的参数, 空数组slice后返回的仍然是空数组</span></span><br><span class="line">    <span class="keyword">let</span> result = context.fn(...args); <span class="comment">//隐式绑定,当前函数的this指向了context.</span></span><br><span class="line">    <span class="keyword">delete</span> context.fn;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>apply的实现和call很类似，但是需要注意他们的参数是不一样的，apply的第二个参数是数组或类数组.</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Function.prototype<span class="built_in">.apply</span> = <span class="keyword">function</span> (<span class="keyword">context</span>, rest) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">context</span>) &#123;</span><br><span class="line">        //<span class="keyword">context</span>为null或者是undefined时,设置默认值</span><br><span class="line">        <span class="keyword">context</span> = typeof <span class="keyword">window</span> === <span class="string">'undefined'</span> ?global :<span class="keyword">window</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">context</span>.fn = this;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">context</span>.fn(...rest);</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">context</span>.fn;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>bind 和 call/apply 有一个很重要的区别，一个函数被 call/apply 的时候，会直接调用，但是 bind 会创建一个新函数。当这个新函数被调用时，bind() 的第一个参数将作为它运行时的 this，之后的一序列参数将会在传递的实参前传入作为它的参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.bind = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="keyword">this</span> !==<span class="string">"function"</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"not a function"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">let</span> args = [...arguments].slice(<span class="number">1</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    Fn.prototype = <span class="keyword">this</span>.prototype;</span><br><span class="line">    <span class="keyword">let</span> bound = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> res = [...args, ...arguments]; <span class="comment">//bind传递的参数和函数调用时传递的参数拼接</span></span><br><span class="line">        context = <span class="keyword">this</span> <span class="keyword">instanceof</span> Fn ?<span class="keyword">this</span> :context || <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">return</span> self.apply(context, res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//原型链</span></span><br><span class="line">    bound.prototype = <span class="keyword">new</span> Fn();</span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="23-取数组最大值"><a href="#23-取数组最大值" class="headerlink" title="23.取数组最大值"></a>23.取数组最大值</h5><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5 的写法</span></span><br><span class="line">Math.max.apply(null, [<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>, <span class="number">30</span>]);</span><br><span class="line"><span class="comment">// ES6 的写法</span></span><br><span class="line">Math.max(...[<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>, <span class="number">30</span>]);</span><br></pre></td></tr></table></figure>
<h5 id="24-统计一个字符串中出现次数最多字符。"><a href="#24-统计一个字符串中出现次数最多字符。" class="headerlink" title="24.统计一个字符串中出现次数最多字符。"></a>24.统计一个字符串中出现次数最多字符。</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">maxN</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//定义一个json对象用于保存str的每一项以及出现次数。</span></span><br><span class="line">    <span class="keyword">var</span> json = &#123;&#125;;</span><br><span class="line">    <span class="comment">//遍历str,循环其中的每一个字符，将某个字符的值及出现的个数拿出来作为json的key和value</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;str.length;i++)&#123;</span><br><span class="line">        <span class="comment">//判断json中是否有当前str的值</span></span><br><span class="line">        <span class="keyword">if</span>(!json[str.charAt(i)])&#123;</span><br><span class="line">            <span class="comment">//如果不存在 就将当前值添加到json中去，并设置1</span></span><br><span class="line">            json[str.charAt(i)] = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//如果存在的话就让数组中已有的当前值的value值++；</span></span><br><span class="line">            json[str.charAt(i)] ++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//存储出现次数最多的值和次数</span></span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">number</span> = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//遍历json  使用打擂算法统计需要的值</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j <span class="keyword">in</span> json)&#123;</span><br><span class="line">        <span class="comment">//如果当前项大于下一项</span></span><br><span class="line">        <span class="built_in">console</span>.log(j,json[j])</span><br><span class="line">        <span class="keyword">if</span> (json[j]&gt;num) &#123;</span><br><span class="line">            <span class="comment">//就让当前值更改为出现最多次数的值</span></span><br><span class="line">            num = json[j];</span><br><span class="line">            <span class="built_in">number</span> = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="built_in">number</span>:<span class="built_in">number</span>,</span><br><span class="line">        num:num</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'qweqrtyuiqqqwrtyudfgerqtywer'</span>;</span><br><span class="line"><span class="keyword">var</span> result = maxN(str);</span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">'该字符串出现'</span>+ result.num+<span class="string">'次的'</span>+ result.number);</span><br></pre></td></tr></table></figure>
<h5 id="24-two-sum找出一个数组中和为给定值的两个数的下标"><a href="#24-two-sum找出一个数组中和为给定值的两个数的下标" class="headerlink" title="24.two-sum找出一个数组中和为给定值的两个数的下标?"></a>24.two-sum找出一个数组中和为给定值的两个数的下标?</h5><ul>
<li>采用hashMap存储数组，key–&gt;数组val  ，val–&gt;数组索引。</li>
<li>遍历集合，target减去当前值，判断当前值是否存在于集合中，如果存在返回索引<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var twoSum2 = <span class="function"><span class="keyword">function</span><span class="params">(nums, target)</span> &#123;</span></span><br><span class="line">    var hash = &#123;&#125;;</span><br><span class="line">    var <span class="built_in">i</span>;</span><br><span class="line">    var tmp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">i</span> = nums.<span class="built_in">length</span>; <span class="built_in">i</span>--; ) &#123;</span><br><span class="line">        tmp = nums[<span class="built_in">i</span>];</span><br><span class="line">        <span class="keyword">if</span> (typeof hash[tmp] !== <span class="string">"undefined"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> [<span class="built_in">i</span>, hash[tmp]];</span><br><span class="line">        &#125;</span><br><span class="line">        hash[target - tmp] = <span class="built_in">i</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hash</span><br><span class="line">&#125;;</span><br><span class="line">var arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">6</span>];</span><br><span class="line">console.<span class="built_in">log</span>(twoSum2(arr,<span class="number">6</span>))</span><br></pre></td></tr></table></figure></li>
</ul>
</div><div class="tags"><a href="/tags/js/">js</a></div><div class="post-nav"><a class="pre" href="/2018/03/27/ES6简介/">ES6简介</a><a class="next" href="/2017/06/14/git常用命令/">git常用命令</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://gongwlin.github.io"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Redux/" style="font-size: 15px;">Redux</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/html/" style="font-size: 15px;">html</a> <a href="/tags/js/" style="font-size: 15px;">js</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/03/14/移动端HTML5的input常见问题/">移动端HTML5的input常见问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/06/Redux简介之核心API/">Redux简介之核心API</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/05/Redux简介之基本概念/">Redux简介之基本概念</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/14/React-Redux的基础用法/">React-Redux的基础用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/27/ES6简介/">ES6简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/04/常用JavaScript代码片段/">常用JavaScript代码片段</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/git常用命令/">git常用命令</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 作品集</i></div><ul></ul><a href="http://project.gongwlin.cn/" title="库存管理系统" target="_blank">库存管理系统</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">少平.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.2" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.2" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.2"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.2"></script></div></body></html>